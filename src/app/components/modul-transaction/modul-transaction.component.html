<app-header></app-header>

<div class="content">

  <div class="ctHeadTb">
    <div>
      <button
        mat-flat-button
        type="button"
        color="primary"
        (click)="openDialog()">
        New transaction
      </button>
    </div>
    <div>
      <mat-form-field appearance="outline">
        <mat-label>Filter</mat-label>
        <input matInput (keyup)="applyFilter($event)" placeholder="Filter..." #input>
      </mat-form-field>
    </div>
  </div>

  <div class="ctTotal">
    <div>
      <div>
        <p><b>Saldo Actual</b></p>
        <h3 [ngClass]="total >= 0 ? 'clEntry' : 'clSpent'">{{total | currency}}</h3>
      </div>
      <div>
        <p><b>Total de gasto</b></p>
        <h3 class="clSpent">- {{totalSpent | currency}}</h3>
      </div>
      <div>
        <p><b>Total de ingreso</b></p>
        <h3 class="clEntry">{{totalEntry | currency}}</h3>
      </div>
    </div>
  </div>

  <div>
    <table mat-table [dataSource]="dataSource" matSort>

      <ng-container matColumnDef="category">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Category </th>
        <td mat-cell *matCellDef="let row">
          <span class="category" [ngClass]="row.category"></span>
          <div class="ctCategory">
            <ng-container *ngFor="let item of getListCategories">
              <div *ngIf="item.name === row.categoryOpc">
                <i class="fa-light" [ngClass]="item.icon" [ngStyle]="{'background-color': item.color}"></i>
              </div>
            </ng-container>
            <div>
              <b>
                {{row.category}}
              </b>
              <p>
                {{row.categoryOpc}}
              </p>
            </div>
          </div>
        </td>
      </ng-container>

      <ng-container matColumnDef="date">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Date </th>
        <td mat-cell *matCellDef="let row"> {{row.date | date}} </td>
      </ng-container>
      <ng-container matColumnDef="notes">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Notes </th>
        <td mat-cell *matCellDef="let row">
          <div class="text_overflow">
            {{row.notes}}
          </div>
        </td>
      </ng-container>
      <ng-container matColumnDef="labels">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Labels </th>
        <td mat-cell *matCellDef="let row">
          <span *ngFor="let label of row.labels" class="label">
            {{label}}
          </span>
        </td>
      </ng-container>
      <ng-container matColumnDef="amoint">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Amoint </th>
        <td
          mat-cell
          *matCellDef="let row"
          [ngClass]="row.category">
          {{row.amoint | currency}}
        </td>
      </ng-container>
      <ng-container matColumnDef="coin">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Coin </th>
        <td mat-cell *matCellDef="let row">
          <p>{{row.coin}}</p>
        </td>
      </ng-container>
      <!-- <ng-container matColumnDef="img">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Img </th>
        <td mat-cell *matCellDef="let row"> {{row.img}} </td>
      </ng-container> -->
      <ng-container matColumnDef="action">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Action </th>
        <td mat-cell *matCellDef="let row">
          <div class="actionTable" style="width: 80px;">
            <button
              class="btn btn_info_table"
              color="primary"
              (click)="editTransaction(row)"
              matTooltip="Edit"
              matTooltipPosition="above">
              <i class="fa-light fa-pen-to-square"></i>
            </button>
            <button
              class="btn btn_warn_table"
              color="warn"
              (click)="deleteTransaction(row._id)"
              matTooltip="Delete"
              matTooltipPosition="above">
              <i class="fa-light fa-trash-can"></i>
            </button>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

      <!-- Row shown when there is no matching data. -->
      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell" colspan="4">No data matching the filter "{{input.value}}"</td>
      </tr>
    </table>

    <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator>
  </div>
</div>